DOCUMENTATION:
  author:
    - Doston Toirov (@dtoirov)
  short_description: Receive events via a webhook.
  description:
    - An ansible-rulebook event source module for receiving events via a webhook.
      The message must be a valid JSON object.

      The body received from the webhook post is placed under the key payload in
      the data pushed to the event queue. Do not expect the host(s) in the path
      "payload.meta.limit" will be automatically used to limit an ansible action
      running on these hosts. Use insert_hosts_to_meta filter instead. See
      https://ansible.readthedocs.io/projects/rulebook/en/latest/host_limit.html
      for more details.
  version_added: '2.4.0'
  options:
    host:
      description:
        - The hostname to listen to.
      type: str
      default: "0.0.0.0"
    port:
      description:
        - The TCP port to listen to..
      type: str
      default: "5000"
    token:
      description:
        - The optional authentication token expected from client.
      type: str
    certfile:
      description:
        - The optional path to a certificate file to enable TLS support.
      type: str
    keyfile:
      description:
        - The optional path to a key file to be used together with certfile.
      type: str
    password:
      description:
        - The optional password to be used when loading the certificate chain.
      type: str
    cafile:
      description:
        - The optional path to a file containing CA certificates used to validate clients' certificates
      type: str
    capath:
      description:
        - The optional path to a directory containing CA certificates.
        - Provide either cafile or capath to enable mTLS support.
      type: str
    hmac_secret:
      description:
        - The optional HMAC secret used to verify the payload from the client.
      type: str
    hmac_algo:
      description:
        - The optional HMAC algorithm used to calculate the payload hash.
        - See your python's hashlib.algorithms_available set for available options.
      type: str
      default: "sha256"
    hmac_reader:
      description:
        - The optional HMAC header sent by the client with the payload signature.
      type: str
      default: "x-hub-signature-256"
    hmac_format:
      description:
        -The optional HMAC signature format format.
      type: str
      default: "hex"
      choices: ["hex", "base64"]
